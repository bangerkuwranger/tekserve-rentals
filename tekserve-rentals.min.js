function isValidDate(e){return"[object Date]"!==Object.prototype.toString.call(e)?!1:!isNaN(e.getTime())}function tekserveRentalsCompareDates(e,t){var r=864e5,s=e.getTime(),a=t.getTime(),n=a-s,l=Math.round(n/r),i=0,o=0,d=0;l>7?l>13?(o=1,d=Math.floor((l-7)/7),i=l-7*(d+1)):(o=1,i=l-7):l>1&&(i=l-1);var v=new Array;return v[0]=l,v[1]=i,v[2]=o,v[3]=d,v}function tekserveRentalsUpDates(e,t){var r,s,a,n,l,i,o,d,v,c,u=parseInt(0);simpleCart.quantity()>0?simpleCart.each(function(p){p.set("start",e),p.set("end",t),r=p.get("dprice"),s=p.get("edprice"),a=p.get("wprice"),n=p.get("ewprice"),l=p.get("deposit"),i=p.get("quantity"),o=tekserveRentalsItemPrice(e,t,r,s,a,n),p.set("price",o[0]),l=parseInt(l)*parseInt(i),u+=l,d=simpleCart.grandTotal()+u,v=o[1],c=o[4],jQuery(".tekserverentals-cart-duration-value").html(Math.abs(v)),jQuery(".tekserverentals-cart-deposits").html("$"+u),jQuery(".tekserverentals-cart-grand-total").html("$"+d.toFixed(2)),"longTerm"==c?(jQuery(".tekserverentals-cart-message p.duration").text(tekserveRentalsMessages.duration),jQuery(".tekserverentals-cart-message").show()):(jQuery(".tekserverentals-cart-message p.duration").text(""),jQuery(".tekserverentals-cart-message p.shipping").text()||jQuery(".tekserverentals-cart-message").hide())}):(v=tekserveRentalsCompareDates(e,t),jQuery(".tekserverentals-cart-duration-value").html(Math.abs(v[0])),jQuery(".tekserverentals-cart-deposits").html("$0.00"),jQuery(".tekserverentals-cart-grand-total").html("$0.00")),simpleCart.update()}function tekserveRentalsItemPrice(e,t,r,s,a,n){var l,i,o=tekserveRentalsCompareDates(e,t),d="shortTerm",v=r,c=1,u=0,p=o[0],k=o[1],h=o[2],m=o[3];h>0?m>0?k>0?(l=parseInt(a)+s*k+n*m,i=parseInt(a)+parseInt(n)+n*m,l>i?(v=i,c=0,u=parseInt(m)+1):(v=l,c=k,u=parseInt(m)+1)):(v=parseInt(a)+n*m,c=0,u=parseInt(m)+1):k>0?(l=parseInt(a)+s*k+n*m,i=parseInt(a)+parseInt(n)+n*m,l>i?(v=i,c=0,u=parseInt(m)+1):(v=l,c=k,u=parseInt(m)+1)):(v=a,c=0,u=1):k>0&&(l=parseInt(r)+s*k,l>a?(v=a,c=0,u=1):(v=l,c=p)),m>2&&(d="longTerm");var y=new Array;return y[0]=v,y[1]=p,y[2]=c,y[3]=u,y[4]=d,y}function dateButton(e){var t=new Date(jQuery($tekserveRentalsFields.startDate).val()),r=new Date(jQuery($tekserveRentalsFields.endDate).val()),s=new Date;return isValidDate(t)&&isValidDate(r)?s>t||s>r?(alert("Time machine is for data backup, not actual time travel. Please choose dates in the future."),toggleCart("hide"),!1):t>r?(tekserveRentalsUpDates(r,t),toggleCart("show"),!0):(tekserveRentalsUpDates(t,r),toggleCart("show"),!0):("first"!==e&&alert("Please enter both a start and end date for this rental."),toggleCart("hide"),!1)}function updateTotals(){var e=new Date(jQuery($tekserveRentalsFields.startDate).val()),t=new Date(jQuery($tekserveRentalsFields.endDate).val());isValidDate(e)&&isValidDate(t)&&tekserveRentalsUpDates(e,t)}function updateShipping(){var e,t,r,s,a,n=0,l=0;if(jQuery($tekserveRentalsFields.delivery).prop("checked")&&(n=1,e=jQuery($tekserveRentalsFields.deliveryLoc).filter(":checked").val()),jQuery($tekserveRentalsFields.pickup).prop("checked")&&(l=1,t=jQuery($tekserveRentalsFields.pickupLoc).filter(":checked").val()),!n&&!l)return jQuery(".tekserverentals-cart-message p.shipping").text(""),jQuery(".tekserverentals-cart-message p.duration").text()||jQuery(".tekserverentals-cart-message").hide(),0;var i=0;return simpleCart.each(function(e){(e.get("name").indexOf("Mac")>-1||e.get("name").indexOf("iPad")>-1)&&(i+=parseInt(e.get("quantity")))}),r=n?"manhattan"==e&&5>i?tekserveRentalsShipcost.mansm:"borough"==e&&5>i?tekserveRentalsShipcost.borsm:"borough"==e&&i>4&&11>i?tekserveRentalsShipcost.borlg:"manhattan"==e&&i>4&&11>i?tekserveRentalsShipcost.manlg:tekserveRentalsShipcost.error:0,s=l?"manhattan"==t&&5>i?tekserveRentalsShipcost.mansm:"borough"==t&&5>i?tekserveRentalsShipcost.borsm:"borough"==t&&i>4&&11>i?tekserveRentalsShipcost.borlg:"manhattan"==t&&i>4&&11>i?tekserveRentalsShipcost.manlg:tekserveRentalsShipcost.error:0,a=parseInt(r)+parseInt(s),a>499?(jQuery(".tekserverentals-cart-message p.shipping").text(tekserveRentalsMessages.shipping),jQuery(".tekserverentals-cart-message").show(),0):(jQuery(".tekserverentals-cart-message p.shipping").text(""),jQuery(".tekserverentals-cart-message p.duration").text()||jQuery(".tekserverentals-cart-message").hide(),a)}function updateExtraData(e){var t=0,r=0;jQuery($tekserveRentalsFields.delivery).prop("checked")&&(t=1),jQuery($tekserveRentalsFields.pickup).prop("checked")&&(r=1),e.start_date=jQuery($tekserveRentalsFields.startDate).val(),e.end_date=jQuery($tekserveRentalsFields.endDate).val(),e.deposits_total=jQuery(".tekserverentals-cart-deposits").html(),e.duration=jQuery(".tekserverentals-cart-duration-value").html(),e.delivery=t,e.delivery_loc=jQuery($tekserveRentalsFields.deliveryLoc).filter(":checked").val(),e.pickup=r,e.pickup_loc=jQuery($tekserveRentalsFields.pickupLoc).filter(":checked").val(),e.first_name=jQuery($tekserveRentalsFields.firstName).val(),e.last_name=jQuery($tekserveRentalsFields.lastName).val(),e.company=jQuery($tekserveRentalsFields.company).val(),e.email=jQuery($tekserveRentalsFields.email).val(),e.phone=jQuery($tekserveRentalsFields.phone).val(),e.address_one=jQuery($tekserveRentalsFields.addressOne).val(),e.address_two=jQuery($tekserveRentalsFields.addressTwo).val(),e.city=jQuery($tekserveRentalsFields.city).val(),e.state=jQuery($tekserveRentalsFields.state).val(),e.zip=jQuery($tekserveRentalsFields.zip).val(),e.comments=jQuery($tekserveRentalsFields.additionalInfo).val(),e.total_price=jQuery(".simpleCart_grandTotal").html()}function bindAllCartActions(){simpleCart.bind("afterAdd",function(e){jQuery(".tekserverentals-cart-container").is(":visible")||alert(e.get("name")+" has been added to the cart!"),updateTotals()}),simpleCart.bind("afterIncrement",function(){updateTotals()}),simpleCart.bind("afterDecrement",function(){updateTotals()}),simpleCart.bind("afterRemove",function(){updateTotals()}),simpleCart.bind("beforeCheckout",function(e){updateExtraData(e);var t=!0,r=new Array,s=0;if(jQuery(".tekserverental-dates-form").first().find("input.required").each(function(){(""==jQuery(this).val()||null==jQuery(this).val()||jQuery(this).hasClass("error"))&&(t=!1,jQuery(this).addClass("error"),r[s]=jQuery(this).attr("id"),s++)}),jQuery(".tekserverental-checkout-form form").first().find("input.required").each(function(){(""==jQuery(this).val()||null==jQuery(this).val()||jQuery(this).hasClass("error"))&&(t=!1,jQuery(this).addClass("error"),r[s]=jQuery(this).attr("id"),s++)}),!t){var a,n='<label class="error" style="font-size: 2em;">Please Fill Out These Fields:</label><br/><ul class="errorlist">';for(s=0;s<r.length;s++)a=jQuery('label[for="'+r[s]+'"]').html(),n+='<li><a href="#'+r[s]+'">'+a+"</a></li>";return n+="</ul>",jQuery(".tekserverental-checkout-form").first().find(".validationerrors").html(n),scrollToID("tekserve-rentals-submit"),"function"==typeof bindAnchors&&bindAnchors(),!1}})}function createCartButtons(){jQuery(".tekserverentals-show-cart-button-container").each(function(){var e=areYouMyMother(this);jQuery(this).append('<a class="cartbutton button" href="#!">Show Cart</a>'),jQuery(this).children("a").click(function(t){t.preventDefault(),moveCartHere(e.parent),scrollToID("tekserve-rentals-cart")})})}function toggleCart(e){"show"===e?(jQuery(".tekserverentals-cart-container").slideDown(),jQuery(".tekserverentals-show-cart-button-container").fadeIn()):"hide"===e?(jQuery(".tekserverentals-cart-container").slideUp(),jQuery(".tekserverentals-show-cart-button-container").fadeOut()):toggleCart(jQuery(".tekserverentals-cart-container").filter(":visible").length>0?"hide":"show")}function moveCartHere(e){var t=areYouMyMother(jQuery(".tekserverentals-cart-container").first());if(t.isVC&&t.hasSiblings){var r='<div class="wpb_wrapper"><div class="vc_empty_space" style="height: 2em"><span class="vc_empty_space_inner"></span></div></div>';jQuery(t.parent).after(r),jQuery(t.parent).closest(".vc_row .innerRowWrap").length>0?(jQuery(t.parent).wrap('<div class="innerRowWrap"></div>'),jQuery(t.parent).closest(".innerRowWrap").wrap('<div class="vc_row wpb_row vc_row-fluid"></div>')):jQuery(t.parent).wrap('<div class="vc_row wpb_row vc_row-fluid"></div>'),t.parent=jQuery(t.parent).closest(".vc_row")}var s=jQuery(t.parent).detach();jQuery(s).hide(),jQuery(e).after(s),jQuery(s).slideDown()}function areYouMyMother(e){var t={parent:"",isVC:!1,hasSiblings:!1};return t.parent=jQuery(e).closest(".vc_row .vc_column_container"),t.parent.length<1?(t.parent=e,t):(t.isVC=!0,jQuery(t.parent).siblings().length>0?(t.hasSiblings=!0,t):(t.parent=jQuery(e).closest(".vc_row"),t))}var tekserveRentalsUrl=tekserveRentalsData.tekserveRentalsUrl+"request.php",tekserveRentalsMessages={duration:"This quote is for a long term rental. The actual price of this rental will be lower than the estimate below. Please contact us directly at 212.929.3645 or rentals@tekserve.com to get the lowest price for this rental.",shipping:"This order has too many items to provide an accurate shipping estimate. Please contact us directly at rentals@tekserve.com or 212.929.3645 to get the price for shipping this rental."},tekserveRentalsAnchors={dates:'<a class="shift-up-16em" style="position: relative; top: -16em;" id="tekserve-rentals-dates" name="tekserve-rentals-dates"></a>',checkout:'<a class="shift-up-16em" style="position: relative; top: -16em;" id="tekserve-rentals-checkout" name="tekserve-rentals-checkout"></a>',submit:'<a class="shift-up-16em" style="position: relative; top: -16em;" id="tekserve-rentals-submit" name="tekserve-rentals-submit"></a>',cart:'<a class="shift-up-16em" style="position: relative; top: -16em;" id="tekserve-rentals-cart" name="tekserve-rentals-cart"></a>'},tekserveRentalsShipcost={mansm:42,manlg:62,borsm:55,borlg:62,error:500},$tekserveRentalsFields={};jQuery(document).ready(function(e){var t=e(".tekserverental-dates-form").first(),r=e(".tekserverental-checkout-form").first().find(".tekserverental-checkout-shipping"),s=e(".tekserverental-checkout-form").first().find(".tekserverental-checkout-custinfo");$tekserveRentalsFields.startDate=e(t).find(".tekserverental-dates-start input"),$tekserveRentalsFields.endDate=e(t).first().find(".tekserverental-dates-end input"),$tekserveRentalsFields.delivery=e(r).find(".tekserverental-delivery input:checkbox"),$tekserveRentalsFields.deliveryLoc=e(r).find('.tekserverental-delivery input[name="tekserverentals-delivery-loc"]:radio'),$tekserveRentalsFields.pickup=e(r).find(".tekserverental-pickup input:checkbox"),$tekserveRentalsFields.pickupLoc=e(r).find('.tekserverental-pickup input[name="tekserverentals-pickup-loc"]:radio'),$tekserveRentalsFields.firstName=e(s).find(".tekserverental-name span.firstname input"),$tekserveRentalsFields.lastName=e(s).find(".tekserverental-name span.lastname input"),$tekserveRentalsFields.company=e(s).find("div.tekserverental-company-name input"),$tekserveRentalsFields.email=e(s).find("div.tekserverental-email input"),$tekserveRentalsFields.phone=e(s).find("div.tekserverental-phone-number input"),$tekserveRentalsFields.addressOne=e(s).find("div.tekserverental-address .addressone input"),$tekserveRentalsFields.addressTwo=e(s).find("div.tekserverental-address .addresstwo input"),$tekserveRentalsFields.city=e(s).find("div.tekserverental-address .city input"),$tekserveRentalsFields.state=e(s).find("div.tekserverental-address .state input"),$tekserveRentalsFields.zip=e(s).find("div.tekserverental-address .zip input"),$tekserveRentalsFields.additionalInfo=e(".tekserverental-checkout-form").first().find(".tekserverental-additional-info textarea"),simpleCart({cartColumns:[{attr:"name",label:"Name"},{attr:"price",label:"Price",view:"currency"},{attr:"deposit",label:"Deposit",view:"currency"},{view:"decrement",label:!1,text:"-"},{attr:"quantity",label:"Qty"},{view:"increment",label:!1,text:"+"},{view:"remove",text:"Remove",label:!1}],checkout:{type:"SendForm",url:tekserveRentalsUrl,method:"POST",extra_data:{storename:"Tekserve Rentals",start_date:e($tekserveRentalsFields.startDate).val(),end_date:e($tekserveRentalsFields.endDate).val(),deposits_total:e(".tekserverentals-cart-deposits").first().html(),duration:e(".tekserverentals-cart-duration-value").first().html(),delivery:0,delivery_loc:e($tekserveRentalsFields.deliveryLoc).filter(":checked").val(),pickup:0,pickup_loc:e($tekserveRentalsFields.pickupLoc).filter(":checked").val(),first_name:e($tekserveRentalsFields.firstName).val(),last_name:e($tekserveRentalsFields.lastName).val(),company:e($tekserveRentalsFields.company).val(),email:e($tekserveRentalsFields.email).val(),phone:e($tekserveRentalsFields.phone).val(),address_one:e($tekserveRentalsFields.addressOne).val(),address_two:e($tekserveRentalsFields.addressTwo).val(),city:e($tekserveRentalsFields.city).val(),state:e($tekserveRentalsFields.state).val(),zip:e($tekserveRentalsFields.zip).val(),comments:e($tekserveRentalsFields.additionalInfo).val(),total_price:e(".simpleCart_grandTotal").first().html()}},cartStyle:"table",currency:"USD",shippingCustom:function(){var e=updateShipping();return e},taxRate:.08875,taxShipping:!0}),e($tekserveRentalsFields.startDate).datepicker(),e($tekserveRentalsFields.endDate).datepicker(),e($tekserveRentalsFields.endDate).data("old",0),e($tekserveRentalsFields.startDate).change(function(){var t;t=dateButton(0==e($tekserveRentalsFields.endDate).data("old")?"first":""),t&&updateTotals(),e(this).removeClass("error")}),e($tekserveRentalsFields.endDate).change(function(){0!=e(this).data("old")||e(this).val()?e(this).data("old",e(this).val()):e(this).data("old","empty");var t=dateButton("");t&&updateTotals(),e(this).removeClass("error")}),e(r).find("input").change(function(){simpleCart.update(),updateTotals()}),e(".emptyCart-button").click(function(){simpleCart.update(),simpleCart.empty(),simpleCart.update(),updateTotals(),simpleCart.save()}),bindAllCartActions(),e.validator.setDefaults({debug:!0,success:"valid"}),e(".tekserverental-checkout-form form").first().validate({rules:{firstname:{required:!0},lastname:{required:!0},emailaddress:{required:!0,email:!0},phonenumber:{required:!0,phoneUS:!0},addressone:{required:!0},city:{required:!0},state:{required:!0,stateUS:!0},zip:{required:!0,zipcodeUS:!0}}}),e(".tekserverental-dates-form form").first().validate({rules:{startdate:{required:!0,date:!0},enddate:{required:!0,date:!0}}})}),jQuery(window).bind("load",function(){jQuery(".tekserverental-dates").length>0&&jQuery(".tekserverental-dates").first().before(tekserveRentalsAnchors.dates),jQuery(".tekserverental-checkout-form").length>0&&jQuery(".tekserverental-checkout-form").first().before(tekserveRentalsAnchors.checkout),jQuery(".tekserverental-checkout-form .tekserverental-checkout-submit").length>0&&jQuery(".tekserverental-checkout-form .tekserverental-checkout-submit").first().before(tekserveRentalsAnchors.submit),jQuery(".tekserverentals-cart").length>0&&jQuery(".tekserverentals-cart-container").first().prepend(tekserveRentalsAnchors.cart),createCartButtons()});